package mods.hinasch.unsaga.lp.event;

import mods.hinasch.unsaga.init.UnsagaConfigHandlerNew;
import mods.hinasch.unsaga.lp.LifePoint;
import net.minecraft.entity.EntityLivingBase;
import net.minecraftforge.event.entity.living.LivingDeathEvent;

/** LPが残ってる限り耐える実装。
*/
public class LPInvulnerabilityHandler {


	public static boolean onLivingDeath(LivingDeathEvent ev){
//		UnsagaMod.logger.trace(EventLPInvulnerability.class.getClass().getName(), "onLivingDeath Called");
		if(UnsagaConfigHandlerNew.GENERAL.enableLPSystem){
//			UnsagaMod.logger.trace(this.getClass().toString(), "called");
			if(LifePoint.adapter.hasCapability(ev.getEntityLiving())){
				EntityLivingBase victim = ev.getEntityLiving();
				int lp = LifePoint.adapter.getCapability(victim).lifePoint();
//				UnsagaMod.logger.trace("on Living Death", "lp",lp,ev.getEntityLiving().getEntityWorld().toString());
				if(lp>0){ //LP０以上なら死なない
					ev.getEntityLiving().setHealth(0.1F); //healではダメ（Life0より上の時だけなので）
					ev.setCanceled(true);
					return false;
				}else{
					return true;
				}
			}
		}
		return true;
	}
}
